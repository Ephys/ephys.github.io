@import url('https://fonts.googleapis.com/css?family=Work+Sans:400,700|Space+Mono:400,700');

$blue: rgb(43, 39, 130);
$red: #bf1f55; //rgb(215, 33, 37);

*, *::after, *::before {
  box-sizing: inherit;
}

html {
  box-sizing: border-box;
}

body {
  margin: 0;
  background: #FAFAFA;
  font-family: 'Work Sans';
}

p {
  line-height: 1.5;
}

.welcome {
  position: fixed;
  top: 0;
  left: 0;
  min-height: 100vh;
  min-width: 100vw;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 10px;

  &::after {
    content: '';
    background-color: #FAFAFA;
    position: absolute;
    height: 100vh;
    width: 100vw;

    transition: background-color ease-in-out 3s;
  }

  &.phase-2 {

    h1::after {
      width: 90%;
    }

    // TODO make following bars appear once after the other (delay this one appearing).
    .description {
      width: 100%;
    }
  }

  > div {
    position: relative;
    z-index: 4;
  }

  .description {
    font-size: 1.2rem;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    overflow: hidden;
    white-space: pre;

    width: 0;

    transition: width 1s ease-in-out;
  }

  p {
    background: black;
    color: white;
    display: inline-block;
    padding: 0.4em 0.7em;
    padding-right: 10%;
    font-family: 'Space Mono';

    margin: 0;
    margin-top: 1.2em;
  }

  h1 {
    margin: 0;
    position: relative;
    line-height: 1.2em;
    transition: color 3s;

    animation: glitch 3s steps(100);
    font-size: 8rem;

    font-family: 'Space Mono';
    text-transform: lowercase;

    $bar-height: calc(1em / 6);

    margin-bottom: $bar-height;

    &::after {
      content: '';

      display: block;
      height: $bar-height;
      width: 0;

      background: currentcolor;

      position: absolute;
      left: 0;
      top: 100%;

      transition: width 1s ease-in-out;
    }
  }
}

@function strip-unit($value) {
  @return $value / ($value * 0 + 1);
}


@mixin fluid-scale($min-vw, $max-vw, $min-font-size, $max-font-size, $propertyName) {
  $u1: unit($min-vw);
  $u2: unit($max-vw);
  $u3: unit($min-font-size);
  $u4: unit($max-font-size);

  @if $u1 == $u2 and $u1 == $u3 and $u1 == $u4 {
    & {
      #{$propertyName}: $min-font-size;
      @media screen and (min-width: $min-vw) {
        #{$propertyName}: calc(#{$min-font-size} + #{strip-unit($max-font-size - $min-font-size)} * ((100vw - #{$min-vw}) / #{strip-unit($max-vw - $min-vw)}));
      }
      @media screen and (min-width: $max-vw) {
        #{$propertyName}: $max-font-size;
      }
    }
  }
}

.main {
  position: relative;
  z-index: 1;
  top: 100vh;

  /* transition: top 1s ease-in-out; */

  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;

  overflow: hidden;
  max-width: 100vw;
}

// TODO:
// - to simplify, make the red square a fixed width and
//   go to responsive mode at some point
// - text width should stay at 520px as long as possible

.about-me-section {
  position: relative;
  background: $blue;

  @include fluid-scale(470px, 1200px, 440px, 600px, width);

  min-height: 75vh;

  color: white;

  --rs-width: 40vw;
  @media (min-width: 1000px) {
    --rs-width: 400px;
  }

  $rs-right-inside-offset: 100px;
  $right-padding: 40px;

  --rs-external-size: calc(var(--rs-width) - #{$rs-right-inside-offset});

  margin-top: 15%;
  margin-bottom: 20%;
  margin-right: var(--rs-external-size);

  padding: 20px $right-padding;

  a {
    color: inherit;
    text-decoration: underline;
  }

  img {
    position: absolute;
    width: 225px;
    top: -40px;
    right: -30px;

    border: 3px white solid;
  }

  &::before {
    content: '';
    display: block;

    height: 400px;

    width: var(--rs-width);

    background: $red;

    float: right;

    $shapePadding: 20px;

    $marginLeft: calc(225px - 35px - #{$rs-right-inside-offset} + #{$shapePadding});

    margin-left: calc(225px - 35px - #{$rs-right-inside-offset} + #{$shapePadding});
    margin-right: calc(#{$rs-right-inside-offset} - #{$right-padding} - var(--rs-width)); //#{$red-square-right-offset};
    margin-top: -120px;
    margin-bottom: 1.5em;

    $top-most-point: -120px;
    $bottom-most-point: calc(100% - 1.5em + #{$shapePadding});
    $horizontal-center-point: calc(#{$marginLeft} - #{$shapePadding});
    $right-most-point: calc(100% + #{$rs-right-inside-offset});
    $left-most-point: 0; // padding is included in margin

    // "horizontal vertical"
    shape-outside: polygon(

      // Top right
      $right-most-point $top-most-point,

      // bottom right
      $right-most-point $bottom-most-point,

      // bottom center
      $horizontal-center-point $bottom-most-point,

      // middle-low center
      $horizontal-center-point 180px,

      // middle-low left
      $left-most-point 180px,

      // middle-high left
      $left-most-point -70px,

      // middle-high center
      $horizontal-center-point -70px,

      // top center
      $horizontal-center-point $top-most-point
    );
  }

  @media (max-width: 470px) {

    width: 100vw;
    margin-right: 0;

    img {
      right: 0;
      border-right: 0;
    }

    &::before {
      height: 80px;
      width: 36vw;

      margin-top: 165px;

      margin-right: -40px;
    }

    h2 {
      margin-top: 200px;
    }
  }
}

h1, h2, h3, h4, h5, h6 {
  font-family: 'Space Mono';
}

//.test2 {
//  border: 2px $red solid;
//  width: 50vw;
//  height: 75vh;
//
//  position: absolute;
//  right: 0;
//  top: 15vh;
//}

@keyframes glitch {
  0%, 4% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }

  5%, 10% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }

  11%, 15% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0.5px);
  }

  16%, 20% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }

  21% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
      /* font-family: monospace; */
  }
  22% {
      text-shadow: 0.8px 10px 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  23% {
      text-shadow: 0.8px -10px 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  24% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  25% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  26% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0.5px);
  }
  27% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0.5px);
  }
  28% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  29% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  30% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }

  31% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  32% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  33% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  34% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  35% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  36% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  37% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  38% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  39% {
      text-shadow: -3px 0 0px #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  40% {
      text-shadow: -3px 0 0px #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  41% {
      text-shadow: 45px 0 0 #0c33f5, -45px 0 0 lime;
      filter: blur(0);
  }
  42% {
      text-shadow: 0 0 0 #0c33f5, 0 0 0 lime;
      filter: blur(0);
  }
  43% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0);
      /* font-family: 'Courier New'; */
  }
  44% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0);
  }
  45% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0);
  }
  46% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0.5px);
  }
  47% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  48% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  49% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  50% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  51% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  52% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  53% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  54% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  55% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0.5px);
  }
  56% {
      text-shadow: -3px -10px 0 red, 3px 0 0 #0c33f5;
      filter: blur(0.5px);
  }
  57% {
      text-shadow: -3px 5px 0 red, 3px 0 0 #0c33f5;
      filter: blur(0.5px);
  }
  58% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  59% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  60% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  61% {
      text-shadow: 30px 0 0 red, -30px 0 0 lime;
      filter: blur(0);
  }
  62% {
      text-shadow: 0 0 0 red, 0 0 0 lime;
      filter: blur(0);
  }
  63% {
      text-shadow: 1px 0 0 red, -1px 0 0 #0c33f5;
      filter: blur(0);
  }
  64% {
      text-shadow: 1px 0 0 red, -1px 0 0 #0c33f5;
      filter: blur(0);
  }
  65% {
      text-shadow: 1px 0 0 red, -1px 0 0 #0c33f5;
      filter: blur(0);
  }
  66% {
      text-shadow: 1px 0 0 red, -1px 0 0 #0c33f5;
      filter: blur(0.5px);
  }
  67% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0.5px);
  }
  68% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  69% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  70% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  71% {
      text-shadow: 50px 0 0 red, -50px 0 0 #0c33f5;
      filter: blur(0);
  }
  72% {
      text-shadow: 0 0 0 red, 0 0 0 #0c33f5;
      filter: blur(0);
  }
  73% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  74% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  75% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  76% {
      text-shadow: 3px 0 0 red, -3px 0 0 #0c33f5;
      filter: blur(0);
  }
  77% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  78% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  79% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  80% {
      text-shadow: -3px 0 0 red, 3px 0 0 #0c33f5;
      filter: blur(0);
  }
  81% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0);
      /* --font: 'Courier New'; */
  }
  82% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0);
      /* --font: 'Space Mono'; */
  }
  83% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0.5px);
  }
  84% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0.5px);
  }
  85% {
      text-shadow: 1px 0 0 red, -1px 0 0 lime;
      filter: blur(0.5px);
  }
  86% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  87% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0.5px);
  }
  88% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  89% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  90% {
      text-shadow: -3px 0 0 red, 3px 0 0 lime;
      filter: blur(0);
  }
  91% {
      text-shadow: 60px 0 0 lime, -60px 0 0 #0c33f5;
      filter: blur(0);
  }
  92% {
      text-shadow: 0 0 0 lime, 0 0 0 #0c33f5;
      filter: blur(0);
  }
  92% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  93% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  94% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  95% {
      text-shadow: 0.8px 0 0 #0c33f5, -0.8px 0 0 lime;
      filter: blur(0);
  }
  96% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  97% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  98% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  99% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
  100% {
      text-shadow: -3px 0 0 #0c33f5, 3px 0 0 lime;
      filter: blur(0);
  }
}

$spacing-h: 40px;
.past-experiences,
.projects {
  max-width: 800px;
  width: calc(100% - #{$spacing-h * 2});
  margin-left: $spacing-h;
  margin-right: $spacing-h;

  margin-bottom: 96px;

  article {
    margin-bottom: 48px;
  }

  .time {
    font-style: italic;
    color: #5d5c5c;
  }

  h3 {
    margin-bottom: 0.15em;
  }
}
